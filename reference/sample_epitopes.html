<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Sample epitopes — sample_epitopes • wavess</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sample epitopes — sample_epitopes"><meta name="description" content="Sample epitopes based on epitope probabilities. Note that the positions
returned assume that the start of the amino acid sequence is also the start
of the founder sequence in the simulation. We also assume that there are no
frameshift mutations in the founder sequence."><meta property="og:description" content="Sample epitopes based on epitope probabilities. Note that the positions
returned assume that the start of the amino acid sequence is also the start
of the founder sequence in the simulation. We also assume that there are no
frameshift mutations in the founder sequence."><meta property="og:image" content="https://molevolepid.github.io/wavess/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">wavess</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/prepare_input_data.html">Prepare input data</a></li>
    <li><a class="dropdown-item" href="../articles/run_wavess.html">Simulate within-host evolution with `wavess`</a></li>
    <li><a class="dropdown-item" href="../articles/analyze_output.html">Analyze wavess output</a></li>
    <li><a class="dropdown-item" href="../articles/python.html">Running wavess in Python</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sample epitopes</h1>

      <div class="d-none name"><code>sample_epitopes.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Sample epitopes based on epitope probabilities. Note that the positions
returned assume that the start of the amino acid sequence is also the start
of the founder sequence in the simulation. We also assume that there are no
frameshift mutations in the founder sequence.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sample_epitopes</span><span class="op">(</span></span>
<span>  <span class="va">epitope_probabilities</span>,</span>
<span>  start_aa_pos <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  end_aa_pos <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  num_epitopes <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  aa_epitope_length <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  max_fit_cost <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  max_resamples <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  ref_founder_map <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-epitope-probabilities">epitope_probabilities<a class="anchor" aria-label="anchor" href="#arg-epitope-probabilities"></a></dt>
<dd><p>Epitope probability tibble as output by
<code><a href="get_epitope_frequencies.html">get_epitope_frequencies()</a></code>, including columns <code>aa_position</code> and
<code>epitope_probability</code>. <code>aa_position</code> should be indexed at 0</p></dd>


<dt id="arg-start-aa-pos">start_aa_pos<a class="anchor" aria-label="anchor" href="#arg-start-aa-pos"></a></dt>
<dd><p>Starting amino acid position to consider for epitopes,
indexed at 0 (default: 0, i.e. the first position)</p></dd>


<dt id="arg-end-aa-pos">end_aa_pos<a class="anchor" aria-label="anchor" href="#arg-end-aa-pos"></a></dt>
<dd><p>Ending amino acid position to consider for epitopes,
indexed at 0 (default: NULL, i.e. through the final position in
<code>epitope_probabilities$aa_position</code>)</p></dd>


<dt id="arg-num-epitopes">num_epitopes<a class="anchor" aria-label="anchor" href="#arg-num-epitopes"></a></dt>
<dd><p>Number of epitopes to sample</p></dd>


<dt id="arg-aa-epitope-length">aa_epitope_length<a class="anchor" aria-label="anchor" href="#arg-aa-epitope-length"></a></dt>
<dd><p>Amino acid epitope length</p></dd>


<dt id="arg-max-fit-cost">max_fit_cost<a class="anchor" aria-label="anchor" href="#arg-max-fit-cost"></a></dt>
<dd><p>Maximum fitness cost of an epitope, must be in the range
[0,1) where 0 indicates no cost. 1, which indicates no ability to
survive, is not allowed (default: 0.3)
<strong>note that the model output is very sensitive to this parameter</strong></p></dd>


<dt id="arg-max-resamples">max_resamples<a class="anchor" aria-label="anchor" href="#arg-max-resamples"></a></dt>
<dd><p>Maximum number of resampling events to attempt; this is
to prevent an infinite loop (default: 100)</p></dd>


<dt id="arg-ref-founder-map">ref_founder_map<a class="anchor" aria-label="anchor" href="#arg-ref-founder-map"></a></dt>
<dd><p>Output from <code><a href="map_ref_founder.html">map_ref_founder()</a></code>, including
<em>nucleotide</em> reference and founder positions (<code>ref_pos</code> and <code>founder_pos</code>).
<strong>NOTE:</strong> The reference positions here, if they were converted to amino
acid positions, are expected to match with the reference positions in
<code>epitope_probabilities</code>. Further, we assume that the founder indices align
with the founder sequence positions to be used in the simulation (default:
NULL)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>tibble with the <code>num_epitopes</code> rows and the following columns:</p><ul><li><p><code>epi_start_nt</code>: nucleotide epitope start position</p></li>
<li><p><code>epi_end_nt</code>: nucleotide epitope end position</p></li>
<li><p><code>max_fitness_cost</code>: maximum fitness cost for that epitope</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">sample_epitopes</span><span class="op">(</span><span class="fu"><a href="get_epitope_frequencies.html">get_epitope_frequencies</a></span><span class="op">(</span><span class="va">env_features</span><span class="op">$</span><span class="va">Position</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2 resamples required</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 10 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    epi_start_nt epi_end_nt max_fitness_cost</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>          273        303             0.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>          486        516             0.06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>          909        939             0.09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>          384        414             0.12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>          456        486             0.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>          702        732             0.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>         <span style="text-decoration: underline;">1</span>173       <span style="text-decoration: underline;">1</span>203             0.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>         <span style="text-decoration: underline;">1</span>251       <span style="text-decoration: underline;">1</span>281             0.24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>         <span style="text-decoration: underline;">1</span>092       <span style="text-decoration: underline;">1</span>122             0.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>          984       <span style="text-decoration: underline;">1</span>014             0.3 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zena Lapp, Narmada Sambaturu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

