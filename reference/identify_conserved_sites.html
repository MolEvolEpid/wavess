<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Identify conserved sites — identify_conserved_sites • wavess</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Identify conserved sites — identify_conserved_sites"><meta name="description" content="Identify conserved sites relative to the founder sequence. Note that the
positions returned assume that the start of the alignment is also the start
of the founder sequence in the simulation."><meta property="og:description" content="Identify conserved sites relative to the founder sequence. Note that the
positions returned assume that the start of the alignment is also the start
of the founder sequence in the simulation."><meta property="og:image" content="https://molevolepid.github.io/wavess/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">wavess</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/prepare_input_data.html">Prepare input data</a></li>
    <li><a class="dropdown-item" href="../articles/run_wavess.html">Simulate within-host evolution with `wavess`</a></li>
    <li><a class="dropdown-item" href="../articles/analyze_output.html">Analyze wavess output</a></li>
    <li><a class="dropdown-item" href="../articles/python.html">Running wavess in Python</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Identify conserved sites</h1>

      <div class="d-none name"><code>identify_conserved_sites.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Identify conserved sites relative to the founder sequence. Note that the
positions returned assume that the start of the alignment is also the start
of the founder sequence in the simulation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">identify_conserved_sites</span><span class="op">(</span></span>
<span>  <span class="va">aln</span>,</span>
<span>  <span class="va">founder</span>,</span>
<span>  thresh <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  ref <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  founder_aln <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-aln">aln<a class="anchor" aria-label="anchor" href="#arg-aln"></a></dt>
<dd><p>Alignment in <a href="https://rdrr.io/pkg/ape/man/DNAbin.html" class="external-link">ape::DNAbin</a> format (e.g. read in with
<code><a href="https://rdrr.io/pkg/ape/man/read.dna.html" class="external-link">ape::read.dna()</a></code> or <code><a href="https://rdrr.io/pkg/ape/man/read.dna.html" class="external-link">ape::read.FASTA()</a></code>) that includes the founder
sequence or a reference sequence, plus a representative set of sequences
for your genome region of interest</p></dd>


<dt id="arg-founder">founder<a class="anchor" aria-label="anchor" href="#arg-founder"></a></dt>
<dd><p>Name of the founder sequence in the input alignment or in the
optional founder-specific alignment (<code>founder_aln</code>)</p></dd>


<dt id="arg-thresh">thresh<a class="anchor" aria-label="anchor" href="#arg-thresh"></a></dt>
<dd><p>Conserved site threshold. A position is considered to be
conserved if &gt;thresh proportion of sequences in the alignment are the same
base (default: 0.99)</p></dd>


<dt id="arg-ref">ref<a class="anchor" aria-label="anchor" href="#arg-ref"></a></dt>
<dd><p>Name of the reference sequence in the input alignment, required if
the founder sequence is not in <code>aln</code> (default: <code>NULL</code>)</p></dd>


<dt id="arg-founder-aln">founder_aln<a class="anchor" aria-label="anchor" href="#arg-founder-aln"></a></dt>
<dd><p>Alignment including the reference and founder sequences,
required if the founder is not present in <code>aln</code>. <strong>NOTE:</strong> This alignment
and <code>aln</code> are assumed to begin at the same position in the reference
sequence (default: <code>NULL</code>)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Tibble including the following columns:</p><ul><li><p><code>founder_pos</code>: founder position</p></li>
<li><p><code>founder_base</code>: founder base</p></li>
<li><p><code>consensus_base</code>: consensus base</p></li>
<li><p><code>consensus_prop</code>: proportion of sequences that had that base at that
position</p></li>
<li><p><code>conserved</code>: whether or not the position is conserved (Yes means conserved,
No means not conserved, NA means the conserved position is a gap ('-'))
When using a reference, <code>NA</code> in the consensus columns indicates that that
position was an insertion relative to the reference. All positions are
indexed at 0.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">gp120_flt_2022</span> <span class="op">&lt;-</span> <span class="fu"><a href="slice_aln.html">slice_aln</a></span><span class="op">(</span><span class="va">hiv_env_flt_2022</span>, start <span class="op">=</span> <span class="fl">1</span>, end <span class="op">=</span> <span class="fl">2517</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gp120_hxb2_cons_founder</span> <span class="op">&lt;-</span> <span class="fu"><a href="slice_aln.html">slice_aln</a></span><span class="op">(</span><span class="va">hxb2_cons_founder</span>, start <span class="op">=</span> <span class="fl">6225</span>, end <span class="op">=</span> <span class="fl">7757</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">identify_conserved_sites</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">gp120_flt_2022</span>,</span></span>
<span class="r-in"><span>  <span class="st">"B.FR.83.HXB2_LAI_IIIB_BRU.K03455"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,023 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    founder_pos founder_base consensus_base consensus_prop conserved</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>           0 a            a                         1   Yes      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>           1 t            t                         1   Yes      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>           2 g            g                         1   Yes      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>           3 a            a                         1   Yes      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>           4 g            g                         1   Yes      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>           5 a            a                         1   Yes      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>           6 g            g                         1   Yes      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>           7 t            t                         0.8 No       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>           8 g            g                         1   Yes      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>           9 a            a                         1   Yes      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1,013 more rows</span></span>
<span class="r-in"><span><span class="fu">identify_conserved_sites</span><span class="op">(</span><span class="va">gp120_flt_2022</span>,</span></span>
<span class="r-in"><span>  <span class="st">"B.US.2011.DEMB11US006.KC473833"</span>,</span></span>
<span class="r-in"><span>  ref <span class="op">=</span> <span class="st">"B.FR.83.HXB2_LAI_IIIB_BRU.K03455"</span>,</span></span>
<span class="r-in"><span>  founder_aln <span class="op">=</span> <span class="va">gp120_hxb2_cons_founder</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,473 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    founder_pos founder_base consensus_base consensus_prop conserved</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>           0 a            a                         1   Yes      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>           1 t            t                         1   Yes      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>           2 g            g                         1   Yes      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>           3 a            a                         1   Yes      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>           4 g            g                         1   Yes      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>           5 a            a                         1   Yes      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>           6 g            g                         1   Yes      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>           7 c            t                         0.8 No       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>           8 g            g                         1   Yes      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>           9 a            a                         1   Yes      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1,463 more rows</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zena Lapp, Narmada Sambaturu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

